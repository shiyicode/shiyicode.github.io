<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-touch-icon.png"><link rel="icon" href="/favicon/favicon-32x32.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Yi Shi"><meta name="keywords" content="shiyi, yishi, threebody, blog, golang"><meta name="description" content="TCP服务特点** 面向连接、基于字节流和可靠传输 ** 。 TCP的面向连接是什么意思？通信双方都必须 ** 先建立连接 ** ，然后才能 ** 开始数据的读写 ** ，双方都必须为该连接分配必要的内核资源，以管理连接的状态和连接上数据的传输。同时，TCP连接是全双工的，就是说， ** 双方数据的读写，可以通过一个连接进行，完成数据交换之后，通信双方都必须断开连接，以释放系统资源 **。而且，T"><meta property="og:type" content="article"><meta property="og:title" content="TCP协议-TCP服务特点和头部结构"><meta property="og:url" content="https://shiyi.threebody.xyz/posts/11603.html"><meta property="og:site_name" content="Yi Shi&#39;s Blog"><meta property="og:description" content="TCP服务特点** 面向连接、基于字节流和可靠传输 ** 。 TCP的面向连接是什么意思？通信双方都必须 ** 先建立连接 ** ，然后才能 ** 开始数据的读写 ** ，双方都必须为该连接分配必要的内核资源，以管理连接的状态和连接上数据的传输。同时，TCP连接是全双工的，就是说， ** 双方数据的读写，可以通过一个连接进行，完成数据交换之后，通信双方都必须断开连接，以释放系统资源 **。而且，T"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2017-02-19T18:22:00.000Z"><meta property="article:modified_time" content="2022-12-08T15:35:14.149Z"><meta property="article:author" content="Yi Shi"><meta property="article:tag" content="网络"><meta name="twitter:card" content="summary_large_image"><title>TCP协议-TCP服务特点和头部结构 - Yi Shi&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"shiyi.threebody.xyz",root:"/",version:"1.9.3",typing:{enable:!0,typeSpeed:50,cursorChar:"",loop:!1,scope:["home"]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!0,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:4},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:"75eaaab59c4fa946437e9dea4f8fc07d",google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:1273342630,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>if(!Fluid.ctx.dnt){var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?75eaaab59c4fa946437e9dea4f8fc07d";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("//s4.cnzz.com/z_stat.php?id=1273342630&show=pic")</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Yi Shi's Blog" type="application/atom+xml">
</head><body><header><div class="header-inner" style="height:40vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Yi Shi&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/books/"><i class="iconfont icon-book"></i> 读书</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/image/banner.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.5)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle">TCP协议-TCP服务特点和头部结构</span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2017-02-20 02:22" pubdate>2017年2月20日 凌晨</time></span></div><div class="mt-1"></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">TCP协议-TCP服务特点和头部结构</h1><div class="markdown-body"><h2 id="TCP服务特点"><a href="#TCP服务特点" class="headerlink" title="TCP服务特点"></a>TCP服务特点</h2><p>** 面向连接、基于字节流和可靠传输 ** 。</p><h3 id="TCP的面向连接是什么意思？"><a href="#TCP的面向连接是什么意思？" class="headerlink" title="TCP的面向连接是什么意思？"></a>TCP的面向连接是什么意思？</h3><p>通信双方都必须 ** 先建立连接 ** ，然后才能 ** 开始数据的读写 ** ，双方都必须为该连接分配必要的内核资源，以管理连接的状态和连接上数据的传输。<br>同时，TCP连接是全双工的，就是说， ** 双方数据的读写，可以通过一个连接进行，完成数据交换之后，通信双方都必须断开连接，以释放系统资源 **<br>。而且，TCP连接是一对一的，所以，基于广播和多播的应用程序不能使用TCP服务，而无连接协议UDP，倒非常适合广播和多播。</p><h3 id="字节流服务和通信报区别"><a href="#字节流服务和通信报区别" class="headerlink" title="字节流服务和通信报区别"></a>字节流服务和通信报区别</h3><p>主要体现在通信双方是否执行相同次数的读写操作。</p><p>![这里写图片描述](<a target="_blank" rel="noopener" href="http://img.blog.csdn.net/20170220000621489?watermark/2/text/aHR0cDo">http://img.blog.csdn.net/20170220000621489?watermark/2/text/aHR0cDo</a><br>vL2Jsb2cuY3Nkbi5uZXQvdG9fYmVfYmV0dGVy/font/5a6L5L2T/fontsize/400/fill/I0JBQkFC<br>MA==/dissolve/70/gravity/SouthEast)</p><p>如图所示，当发送端应用程序同时执行多次写操作时，TCP模块必须先将这些数据放入发送缓冲区中，当TCP模块真正发送数据时，发送缓冲区中这些数据才会被封装成一个<br>或多个TCP报文段发出，简言之， ** TCP模块发出的报文段个数与发送端应用程序执行的写操作次数之间没有固定的数量关系 ** 。<br>同时，当接收端收到一个或多个TCP报文段后，TCP模块要将它们携带的应用数据根据的TCP报文段的序号依次放入接收缓冲区中，同时通知应用程序读取数据。接收端应<br>用程序可以将接收缓冲区中的数据一次读出，也可以多次读出，这取决于用户指定的应用程序读缓冲区大小，简言之， **<br>接收端应用程序执行的读操作次数与TCP模块接收到的TCP报文段个数也没有固定的数量关系。 **<br>总而言之就是， ** 发送端执行的写操作数量和接收端执行的读操作数量之间没有任何的数量关系 ** 。<br>通信双方数据传输是没有边界的，这也就是TCP的字节流的概念。<br>![这里写图片描述](<a target="_blank" rel="noopener" href="http://img.blog.csdn.net/20170220000632880?watermark/2/text/aHR0cDo">http://img.blog.csdn.net/20170220000632880?watermark/2/text/aHR0cDo</a><br>vL2Jsb2cuY3Nkbi5uZXQvdG9fYmVfYmV0dGVy/font/5a6L5L2T/fontsize/400/fill/I0JBQkFC<br>MA==/dissolve/70/gravity/SouthEast)<br>而UDP的数据报截然相反，发送端应用程序每执行一次写操作，接收端应用程序都必须执行一次对应的读操作。否则，就会发生丢包。并且，如果用户没有指定足够的应用数据<br>缓冲区来读取数据报，那么UDP数据报就会发生截断。</p><h3 id="TCP的可靠传输是由何支撑的："><a href="#TCP的可靠传输是由何支撑的：" class="headerlink" title="TCP的可靠传输是由何支撑的："></a>TCP的可靠传输是由何支撑的：</h3><h4 id="发送应答机制"><a href="#发送应答机制" class="headerlink" title="** 发送应答机制 **"></a>** 发送应答机制 **</h4><p>发送端发送的每个TCP报文段都必须得到接收端的应答，才认为这个TCP报文段传输成功。</p><h4 id="超时重传机制"><a href="#超时重传机制" class="headerlink" title="** 超时重传机制 **"></a>** 超时重传机制 **</h4><p>发送端在发出一个TCP报文段之后，就开始定时，如果在定时时间内没有收到应答，就会重新发送这个报文段。<br>同时，TCP报文段最终是以IP数据报发送的，而IP数据报到达接收端时可能乱序、重复，TCP协议还会对接收到的TCP报文段重排、整理，再交付给应用程序。<br>而UDP数据报服务则不可靠，需要上层协议处理数据的确认和超时重传。</p><h2 id="TCP头部结构"><a href="#TCP头部结构" class="headerlink" title="TCP头部结构"></a>TCP头部结构</h2><p>通过了解TCP头部结构，我们可以认识到传输层在TCP协议栈中的作用。<br>TCP头部信息用于指定通信源端端口，目标端端口，管理连接等这些任务。如下图所示：<br>![这里写图片描述](<a target="_blank" rel="noopener" href="http://img.blog.csdn.net/20170220000451567?watermark/2/text/aHR0cDo">http://img.blog.csdn.net/20170220000451567?watermark/2/text/aHR0cDo</a><br>vL2Jsb2cuY3Nkbi5uZXQvdG9fYmVfYmV0dGVy/font/5a6L5L2T/fontsize/400/fill/I0JBQkFC<br>MA==/dissolve/70/gravity/SouthEast)</p><h4 id="32位序号"><a href="#32位序号" class="headerlink" title="** 32位序号 **"></a>** 32位序号 **</h4><blockquote><p>在一次TCP通信，从连接建立到释放连接的整个过程中，在某一个传输方向上的字节流的每个字节的编号就是由这个32位序号确认的。<br>在两个主机通信时，第一次发送的TCP报文段中，32位序号为系统给出的随机值，我们称它为初始序号(ISN)，在该传输方向上，后续的TCP报文段中，序号，将被系<br>统设置为ISN+该报文段所携带数据的第一个字节在整个字节流中位置的偏移。<br>另外一个传输方向上，亦然。</p></blockquote><h4 id="32位确认号"><a href="#32位确认号" class="headerlink" title="** 32位确认号 **"></a>** 32位确认号 **</h4><blockquote><p>TCP报文段中，发送方不仅携带自己的数据序号，还携带对通信另一方所发送的数据的确认。</p></blockquote><h4 id="4位头部长度"><a href="#4位头部长度" class="headerlink" title="** 4位头部长度 **"></a>** 4位头部长度 **</h4><blockquote><p>标识该TCP头部有多少个4字节，最大值是15，所以TCP头部最大长度是60个字节。</p></blockquote><h4 id="6位标志字段"><a href="#6位标志字段" class="headerlink" title="** 6位标志字段 **"></a>** 6位标志字段 **</h4><ul><li>** URG ** ：紧急指针是否有效。</li><li>** ACK ** ：确认号是否有效（我们称携带ACK标志的TCP报文段为确认报文段）。</li><li>** PSH ** ：push字段，提示接收端程序应该立即从TCP接收缓冲区中读走数据，为接收后续数据腾出空间，因为应用程序如果不把这些数据读走，这些数据会一直停留在TCP接收缓冲区中，这样会占用很大的内核资源。</li><li>** RST ** ：要求对方重新建立连接（复位报文段）</li><li>** SYN ** ：表示请求建立一个连接（同步报文段）</li><li>** FIN ** ：通知对方关闭连接（结束报文段）</li><li>** 16位窗口大小 **</li></ul><blockquote><p>是TCP流量控制的手段。这里的窗口指接收通报窗口（Receiver<br>window），提示本端TCP接收缓冲区还能容纳多少字节数据，这样对方就可以控制数据发送的速度。</p></blockquote><ul><li>16位校验和</li></ul><blockquote><p>由发送端填充，接收端对TCP报文段执行CRC算法，来检验数据是否损坏。该检验不仅包括头部，也包括数据部分。</p></blockquote><ul><li>16位紧急指针</li></ul><blockquote><p>表示最后一个紧急数据的下一字节序号。</p></blockquote><p>![这里写图片描述](<a target="_blank" rel="noopener" href="http://img.blog.csdn.net/20170220000541380?watermark/2/text/aHR0cDo">http://img.blog.csdn.net/20170220000541380?watermark/2/text/aHR0cDo</a><br>vL2Jsb2cuY3Nkbi5uZXQvdG9fYmVfYmV0dGVy/font/5a6L5L2T/fontsize/400/fill/I0JBQkFC<br>MA==/dissolve/70/gravity/SouthEast)</p><h4 id="40选项"><a href="#40选项" class="headerlink" title="40选项"></a>40选项</h4><p>kind类型 length总长度 info具体信息（常见TCP选项具体信息如下）</p><p>![这里写图片描述](<a target="_blank" rel="noopener" href="http://img.blog.csdn.net/20170220022113004?watermark/2/text/aHR0cDo">http://img.blog.csdn.net/20170220022113004?watermark/2/text/aHR0cDo</a><br>vL2Jsb2cuY3Nkbi5uZXQvdG9fYmVfYmV0dGVy/font/5a6L5L2T/fontsize/400/fill/I0JBQkFC<br>MA==/dissolve/70/gravity/SouthEast)</p><blockquote><p>0： ** 选项表结束选项 **<br>1： ** 空操作选项 ** 。无特殊含义，一般用于将TCP选项的总长度填充为4字节的整数倍。<br>2： ** 最大报文段长度选项 ** 。连接初始化时，通信双方使用该选项来协商最大报文段长度。TCP模块通常将最大报文段长度设为MTU-40，这里的40指2<br>0字节的TCP头部和20字节的TCP头部，这样一来，携带TCP报文段的IP数据报的长度就不会超过MTU。<br>** ps：MTU即 _ 最大传输单元 _ ，该参数通常与通信接口有关（网络接口卡、串口等）。 **<br>3： ** 窗口扩大因子选项 ** 。TCP连接初始化时，通信双方使用该选项协商接收通道窗口扩大因子的大小。因为在TCP协议中，接收通道窗口的大小是用16位<br>表示的，也就是65535个字节，但实际上TCP模块允许的接收通道窗口远不止这个数目，比这个大是为了提高通信的吞吐量，窗口扩大因子就是为了解决这个问题。<br>如果窗口大小位N，而窗口扩大因子为M，那么窗口实际大小就是N*(2^M)。窗口扩大因子选项只能出现在同步报文段中，当连接建立成功之后，该值将固定不变。<br>4： ** 选择性确认(SACK)选项 ** 。当TCP报文段发生丢失时，TCP模块就会重传最后被确认的TCP报文段之后的所有报文段，但这样的话，原先已经成<br>功发送的报文段也可能重复发送，就降低了TCP模块的性能。选择定确认选项就是为了解决这个问题，它让TCP模块儿只重新发送丢失的TCP报文段。<br>5： ** SACK实际工作的选项 ** 。告诉发送端，本端已经收到的不连续的数据块，从而让发送端根据此选项重新发送丢失的数据块。其中块左边沿表示不连续块的<br>第一个数据的序号，而块右边沿则表示不连续块的最后一个数据的序号的下一个序号。这样一对参数（块左边沿和块右边沿）之间的数据是没有收到的。因为一个块信息占用8字<br>节，所以TCP头部选项中实际上最多可以包含4个这样的不连续数据块（考虑选项类型和长度占用的2字节）。<br>8： ** 时间戳选项 ** 。提供比较准确的计算通信双方之间的回路时间的方法。</p></blockquote></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E5%A4%A7%E5%AD%A6%E6%97%B6%E6%9C%9FCSDN/" class="category-chain-item">大学时期CSDN</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E7%BD%91%E7%BB%9C/">#网络</a></div></div><div class="license-box my-3"><div class="license-title"><div>TCP协议-TCP服务特点和头部结构</div><div>https://shiyi.threebody.xyz/posts/11603.html</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Yi Shi</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2017年2月20日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/posts/22612.html" title="各类游戏对应的服务端架构"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">各类游戏对应的服务端架构</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/posts/23478.html" title="Linux内存管理机制"><span class="hidden-mobile">Linux内存管理机制</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="lv-container" data-id="city" data-uid="MTAyMC80NjEzMS8yMjY0Mg"><script type="text/javascript">Fluid.utils.loadComments("#lv-container",(function(){Fluid.utils.createScript("https://cdn-city.livere.com/js/embed.dist.js")}))</script><noscript>Please enable JavaScript to view the comments</noscript></div></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="beian"><span><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">陕ICP备16019529号-2</a></span></div><span id="cnzz_stat_icon_1273342630" style="display:none"></span></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!0,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>